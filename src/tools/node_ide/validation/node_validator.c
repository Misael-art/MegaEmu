#include "node_validator.h"#include <stdio.h>#include <string.h>#include "../../utils/common_types.h"#include "../../utils/error_handling.h"// Array para armazenar validadores para cada tipo de nóstatic EmuNodeValidator _validators[EMU_NODE_TYPE_COUNT];/** * @brief Registra um validador para um tipo específico de nó */emu_error_t emu_register_node_validator(emu_node_type_t type, EmuNodeValidator validator){    if (type >= EMU_NODE_TYPE_COUNT || type == EMU_NODE_TYPE_INVALID)    {        return EMU_ERROR_INVALID_PARAM;    }    _validators[type] = validator;    return EMU_ERROR_NONE;}/** * @brief Valida um nó usando o validador apropriado para seu tipo */emu_error_t emu_validate_node(EmuNode *node, EmuValidationError *error){    if (!node || !error)    {        return EMU_ERROR_INVALID_PARAM;    }    if (node->type >= EMU_NODE_TYPE_COUNT || node->type == EMU_NODE_TYPE_INVALID)    {        return EMU_ERROR_INVALID_PARAM;    }    EmuNodeValidator *validator = &_validators[node->type];    if (!validator->validate)    {        return EMU_ERROR_NOT_FOUND;    }    if (!validator->validate(node, error))    {        return EMU_ERROR_VALIDATION_FAILED;    }    return EMU_ERROR_NONE;}/** * @brief Exemplo de validador para nó de sprite */static bool _validate_sprite_node(EmuNode *node, EmuValidationError *error){    if (!node || !error)    {        return false;    }    // Validar parâmetros específicos do sprite    bool width_found = false;    bool height_found = false;    float width = 0;    float height = 0;    // Procura pelos parâmetros de largura e altura    for (int i = 0; i < node->params.param_count; i++)    {        emu_node_param_t *param = &node->params.params[i];        if (strcmp(param->name, "width") == 0 && param->type == EMU_PARAM_TYPE_FLOAT)        {            width = param->value.float_value;            width_found = true;        }        else if (strcmp(param->name, "height") == 0 && param->type == EMU_PARAM_TYPE_FLOAT)        {            height = param->value.float_value;            height_found = true;        }    }    // Verifica se os parâmetros obrigatórios existem e são válidos    if (!width_found || !height_found)    {        error->error_code = EMU_VALIDATION_MISSING_REQUIRED_PARAM;        snprintf(error->message, 256, "Sprite node missing required parameters: width and/or height");        return false;    }    if (width <= 0 || height <= 0)    {        error->error_code = EMU_VALIDATION_INVALID_SIZE;        snprintf(error->message, 256, "Invalid sprite dimensions: width and height must be positive");        return false;    }    return true;}
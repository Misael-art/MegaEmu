#include "rom/rom_extractor.h"#include "core/platform_specs.h"#include "core/memory.h"static const PlatformSpec SUPPORTED_PLATFORMS[] = {    {        .type = PLATFORM_NES,        .sprite_patterns = {            .offset = 0x8000,            .size = 8192,            .format = COLOR_FORMAT_2BPP        }    },    {        .type = PLATFORM_MEGADRIVE,        .sprite_patterns = {            .offset = 0x20000,            .size = 32768,            .format = COLOR_FORMAT_4BPP        }    }};bool rom_extractor_analyze(ROMExtractor* extractor) {    if (!extractor || !extractor->rom_path) return false;        // Detecta plataforma baseado no header da ROM    extractor->platform = detect_rom_platform(extractor->rom_path);    if (extractor->platform == PLATFORM_UNKNOWN) return false;        // Configura extrator específico da plataforma    const PlatformSpec* spec = get_platform_spec(extractor->platform);    if (!spec) return false;        // Analisa padrões de sprite na ROM    FILE* rom = fopen(extractor->rom_path, "rb");    if (!rom) return false;        uint8_t* buffer = malloc(spec->sprite_patterns.size);    fseek(rom, spec->sprite_patterns.offset, SEEK_SET);    fread(buffer, 1, spec->sprite_patterns.size, fread);        // Identifica padrões de sprite    extractor->sprites = analyze_sprite_patterns(        buffer,        spec->sprite_patterns.size,        spec->sprite_patterns.format,        &extractor->sprite_count    );        free(buffer);    fclose(rom);    return true;}
/** * @file error_handling.c * @brief Implementação do sistema de tratamento de erros */#include <stdio.h>#include <string.h>#include "error_handling.h"/* Variável global para armazenar informações do último erro */static emu_error_info g_error = {    EMU_ERROR_NONE,    NULL,    NULL,    0};/* Mensagens de erro em português */static const char *g_error_messages[EMU_ERROR_COUNT] = {    "Nenhum erro",                 // EMU_ERROR_NONE (0)    "Erro genérico",               // EMU_ERROR_GENERIC (-1)    "Parâmetro inválido",          // EMU_ERROR_INVALID_PARAMETER (-2)    "Erro de alocação de memória", // EMU_ERROR_OUT_OF_MEMORY (-3)    "Arquivo não encontrado",      // EMU_ERROR_FILE_NOT_FOUND (-4)    "Operação não suportada",      // EMU_ERROR_NOT_SUPPORTED (-5)    "Sistema não inicializado",    // EMU_ERROR_NOT_INITIALIZED (-6)    "Sistema já inicializado",     // EMU_ERROR_ALREADY_INITIALIZED (-7)    "Endereço inválido",           // EMU_ERROR_INVALID_ADDRESS (-8)    "Erro de permissão",           // EMU_ERROR_PERMISSION (-9)    "Estado inválido",             // EMU_ERROR_INVALID_STATE (-10)    "Erro desconhecido",           // EMU_ERROR_UNKNOWN (-11)    "Ponteiro nulo",               // EMU_ERROR_NULL_POINTER (-12)    "Índice fora dos limites"      // EMU_ERROR_OUT_OF_BOUNDS (-13)};void emu_error_init(void){    g_error.code = EMU_ERROR_NONE;    g_error.message = NULL;    g_error.file = NULL;    g_error.line = 0;}void emu_error_shutdown(void){    emu_error_clear();}void emu_error_set(emu_error_t code, const char *message, const char *file, int line){    // Converter códigos inválidos para EMU_ERROR_UNKNOWN    if (code < EMU_ERROR_UNKNOWN || code > EMU_ERROR_NONE)    {        code = EMU_ERROR_UNKNOWN;    }    g_error.code = code;    g_error.message = message;    g_error.file = file;    g_error.line = line;}emu_error_t emu_error_get_code(void){    return g_error.code;}const char *emu_error_get_message(void){    return g_error.message;}const char *emu_error_get_file(void){    return g_error.file;}int32_t emu_error_get_line(void){    return g_error.line;}void emu_error_clear(void){    g_error.code = EMU_ERROR_NONE;    g_error.message = NULL;    g_error.file = NULL;    g_error.line = 0;}bool emu_error_has_error(void){    return g_error.code != EMU_ERROR_NONE;}const char *emu_error_code_to_string(emu_error_t code){    // Ajustar o índice para acessar o array (converter de negativo para positivo)    int index = (code == EMU_ERROR_NONE) ? 0 : (-code);    if (index >= EMU_ERROR_COUNT)    {        return "Código de erro inválido";    }    return g_error_messages[index];}
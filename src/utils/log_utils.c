/** * @file log_utils.c * @brief Implementação do sistema de logging legado */#include "log_utils.h"#include <stdarg.h>#include <string.h>/* Variáveis estáticas */static FILE *g_output = NULL;void emu_log_init_file(const char *filename){    if (g_output != NULL && g_output != stdout && g_output != stderr)    {        fclose(g_output);    }    if (filename != NULL)    {        g_output = fopen(filename, "a");        if (g_output == NULL)        {            EMU_LOG_WARN(EMU_LOG_CAT_CORE, "Não foi possível abrir o arquivo de log: %s", filename);            g_output = stderr;        }    }    else    {        g_output = stderr;    }}void emu_log_close_file(void){    if (g_output != NULL && g_output != stdout && g_output != stderr)    {        fclose(g_output);    }    g_output = NULL;}void emu_log_set_output(FILE *output){    if (output != NULL)    {        if (g_output != NULL && g_output != stdout && g_output != stderr)        {            fclose(g_output);        }        g_output = output;    }}void emu_log_write(emu_log_level_t level, const char *format, ...){    if (g_output == NULL)    {        g_output = stderr;    }    va_list args;    va_start(args, format);    vfprintf(g_output, format, args);    va_end(args);    fflush(g_output);}